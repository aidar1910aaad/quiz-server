# –û—Ç–≤–µ—Ç –±—ç–∫–µ–Ω–¥–µ—Ä–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ—Ä—É: –ü—Ä–æ–±–ª–µ–º–∞ —Å –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ–º –∏–≥—Ä—ã

## ‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ: –ë—ç–∫–µ–Ω–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç –ü–†–ê–í–ò–õ–¨–ù–û

–ü–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ–¥–∞ –º–æ–≥—É –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å, —á—Ç–æ **–±—ç–∫–µ–Ω–¥ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ** –∏ –ø—Ä–æ–±–ª–µ–º–∞, —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞. –ù–∏–∂–µ –ø–æ–¥—Ä–æ–±–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –Ω–∞ –≤—Å–µ –≤–∞—à–∏ –≤–æ–ø—Ä–æ—Å—ã.

---

## 1. –ö–∞–∫–∏–µ —Å–æ–±—ã—Ç–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –∏–≥—Ä—ã?

### ‚úÖ –û–¢–í–ï–¢: –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–æ–±—ã—Ç–∏–π

**–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –≤–æ–ø—Ä–æ—Å–∞ –±—ç–∫–µ–Ω–¥ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç:**

1. **`game-update`** —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `'finished'` (–∏–ª–∏ `'FINISHED'`)
   ```javascript
   {
     gameId: "uuid",
     pin: "123456",
     status: "finished",  // ‚úÖ –°—Ç–∞—Ç—É—Å 'finished'
     currentQuestionIndex: <–ø–æ—Å–ª–µ–¥–Ω–∏–π_–∏–Ω–¥–µ–∫—Å>  // –ò–Ω–¥–µ–∫—Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –≤–æ–ø—Ä–æ—Å–∞
   }
   ```

2. **`quiz-results`** —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –∏–≥—Ä—ã (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
   ```javascript
   {
     quiz: { ... },
     team1: { ... },
     team2: { ... },
     winner: 1 | 2 | null,
     finalPosition: number
   }
   ```

3. **‚ùå –ù–ï –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è `start-question`** –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –≤–æ–ø—Ä–æ—Å–∞

### –ö–æ–¥ –Ω–∞ –±—ç–∫–µ–Ω–¥–µ (—Å—Ç—Ä–æ–∫–∏ 536-567):

```typescript
if (nextIndex >= totalQuestions) {
  // –≠—Ç–æ –±—ã–ª –ø–æ—Å–ª–µ–¥–Ω–∏–π –≤–æ–ø—Ä–æ—Å - –∑–∞–≤–µ—Ä—à–∞–µ–º –∏–≥—Ä—É
  this.logger.log(`üèÅ [Auto Advance] –ü–æ—Å–ª–µ–¥–Ω–∏–π –≤–æ–ø—Ä–æ—Å –∑–∞–≤–µ—Ä—à–µ–Ω...`);

  // –û—á–∏—â–∞–µ–º —Ç–∞–π–º–µ—Ä
  const timer = this.questionTimers.get(quizId);
  if (timer && timer.timerId) {
    clearTimeout(timer.timerId);
  }
  this.questionTimers.delete(quizId);

  // –ó–∞–≤–µ—Ä—à–∞–µ–º –∏–≥—Ä—É
  await this.quizzesService.finishQuiz(quizId, userId);

  // –¢—Ä–∞–Ω—Å–ª–∏—Ä—É–µ–º —Å–æ–±—ã—Ç–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∏–≥—Ä—ã (–ø–µ—Ä–µ–¥–∞–µ–º –∏–Ω–¥–µ–∫—Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –≤–æ–ø—Ä–æ—Å–∞)
  this.emitGameUpdate(pin, quiz.id, QuizStatus.FINISHED, currentQuestionIndex);  // ‚úÖ –û—Ç–ø—Ä–∞–≤–ª—è–µ–º game-update
  
  // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
  this.server.to(roomName).emit('quiz-results', results);
  
  // ‚ùå –ù–ï –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º start-question
}
```

---

## 2. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ–±—ã—Ç–∏—è `game-update` –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏

### ‚úÖ –û–¢–í–ï–¢: –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç

**–ú–µ—Ç–æ–¥ `emitGameUpdate` (—Å—Ç—Ä–æ–∫–∏ 161-169):**

```typescript
emitGameUpdate(pin: string, gameId: string, status: string, currentQuestionIndex?: number) {
  const roomName = `quiz-${pin}`;
  this.server.to(roomName).emit('game-update', {
    gameId,
    pin,
    status,  // ‚úÖ –°—Ç–∞—Ç—É—Å 'finished' –∏–ª–∏ 'FINISHED'
    currentQuestionIndex  // ‚úÖ –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä
  });
}
```

**–ü—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –∏–≥—Ä—ã (–ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è):**
```javascript
this.emitGameUpdate(pin, quiz.id, QuizStatus.FINISHED, currentQuestionIndex);
// –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç:
{
  gameId: quiz.id,
  pin: pin,
  status: "finished",  // ‚úÖ Enum QuizStatus.FINISHED = 'finished'
  currentQuestionIndex: 1  // ‚úÖ –ò–Ω–¥–µ–∫—Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –≤–æ–ø—Ä–æ—Å–∞ (–µ—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–Ω)
}
```

### ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: `currentQuestionIndex` —Ç–µ–ø–µ—Ä—å –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –¢–µ–ø–µ—Ä—å –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –∏–≥—Ä—ã `currentQuestionIndex` –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ `emitGameUpdate` –∏ —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω–¥–µ–∫—Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –≤–æ–ø—Ä–æ—Å–∞.

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ–±—ã—Ç–∏—è `game-update` –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ (–ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è):**
```javascript
{
  gameId: "uuid",
  pin: "123456",
  status: "finished",  // ‚úÖ –°—Ç–∞—Ç—É—Å 'finished'
  currentQuestionIndex: 1  // ‚úÖ –ò–Ω–¥–µ–∫—Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –≤–æ–ø—Ä–æ—Å–∞ (–µ—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–Ω)
}
```

**–ù–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ:**
- –ï—Å–ª–∏ `status === 'finished'`, –∏–≥—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –∑–Ω–∞—á–µ–Ω–∏—è `currentQuestionIndex`
- `currentQuestionIndex` –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω–¥–µ–∫—Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –≤–æ–ø—Ä–æ—Å–∞ (–¥–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏)

---

## 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∏–≥—Ä—ã –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π `start-question`

### ‚úÖ –û–¢–í–ï–¢: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ü–†–ê–í–ò–õ–¨–ù–û

**–í –º–µ—Ç–æ–¥–µ `handleStartQuestion` (—Å—Ç—Ä–æ–∫–∏ 374-393):**

```typescript
// 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∏–≥—Ä—ã
if (quiz.status !== QuizStatus.STARTED) {
  if (quiz.status === QuizStatus.FINISHED) {
    client.emit('error', { 
      message: '–ò–≥—Ä–∞ —É–∂–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∞. –ù–µ–ª—å–∑—è –∑–∞–ø—É—Å—Ç–∏—Ç—å –Ω–æ–≤—ã–π –≤–æ–ø—Ä–æ—Å –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∏–≥—Ä—ã.',
      gameStatus: quiz.status,
      currentQuestionIndex: currentQuestionIndex,
      totalQuestions: quiz.questions.length
    });
    this.logger.warn(`–ü–æ–ø—ã—Ç–∫–∞ –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤–æ–ø—Ä–æ—Å ${currentQuestionIndex} –≤ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω–æ–π –∏–≥—Ä–µ ${pin}`);
  } else {
    client.emit('error', { 
      message: `–ò–≥—Ä–∞ –Ω–µ –∑–∞–ø—É—â–µ–Ω–∞. –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å: ${quiz.status}. –û–∂–∏–¥–∞–µ—Ç—Å—è: '${QuizStatus.STARTED}'`,
      gameStatus: quiz.status,
      expectedStatus: QuizStatus.STARTED
    });
  }
  return { success: false };  // ‚úÖ –ë–ª–æ–∫–∏—Ä—É–µ–º –æ—Ç–ø—Ä–∞–≤–∫—É start-question
}
```

**‚úÖ –í—ã–≤–æ–¥:** –ë—ç–∫–µ–Ω–¥ –ù–ï –æ—Ç–ø—Ä–∞–≤–∏—Ç `start-question` –µ—Å–ª–∏ –∏–≥—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞. –ï—Å–ª–∏ –≤—ã –≤–∏–¥–∏—Ç–µ `start-question` –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è, —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ:
1. –õ–∏–±–æ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ —Å–∞–º –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —ç—Ç–æ —Å–æ–±—ã—Ç–∏–µ
2. –õ–∏–±–æ —ç—Ç–æ —Å–æ–±—ã—Ç–∏–µ –±—ã–ª–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –î–û –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∏–≥—Ä—ã, –Ω–æ –ø—Ä–∏—à–ª–æ –ü–û–°–õ–ï

---

## 4. –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–æ–±—ã—Ç–∏–π –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –∏–≥—Ä—ã

### ‚úÖ –û–¢–í–ï–¢: –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ü–†–ê–í–ò–õ–¨–ù–ê–Ø

**–†–µ–∞–ª—å–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –Ω–∞ –±—ç–∫–µ–Ω–¥–µ:**

```
1. –ü–æ—Å–ª–µ–¥–Ω–∏–π –≤–æ–ø—Ä–æ—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–Ω–¥–µ–∫—Å 1) –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è
   ‚Üì
2. autoAdvanceQuestion –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ —Ç–∞–π–º–µ—Ä—É
   ‚Üì
3. –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è, —á—Ç–æ nextIndex >= totalQuestions (—ç—Ç–æ –ø–æ—Å–ª–µ–¥–Ω–∏–π –≤–æ–ø—Ä–æ—Å)
   ‚Üì
4. –û—á–∏—â–∞–µ—Ç—Å—è —Ç–∞–π–º–µ—Ä (—Å—Ç—Ä–æ–∫–∏ 541-545)
   ‚Üì
5. –í—ã–∑—ã–≤–∞–µ—Ç—Å—è finishQuiz() —á–µ—Ä–µ–∑ API (—Å—Ç—Ä–æ–∫–∞ 548)
   ‚Üì
6. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è game-update —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º 'finished' (—Å—Ç—Ä–æ–∫–∞ 556)
   ‚Üì
7. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è quiz-results —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ (—Å—Ç—Ä–æ–∫–∏ 560-564)
   ‚Üì
8. ‚ùå –ù–ï –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è start-question
```

**‚úÖ –í—ã–≤–æ–¥:** –ë—ç–∫–µ–Ω–¥ —Å–ª–µ–¥—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

---

## 5. –û—á–∏—Å—Ç–∫–∞ —Ç–∞–π–º–µ—Ä–æ–≤ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∏–≥—Ä—ã

### ‚úÖ –û–¢–í–ï–¢: –¢–∞–π–º–µ—Ä—ã –æ—á–∏—â–∞—é—Ç—Å—è –ü–†–ê–í–ò–õ–¨–ù–û

**–ö–æ–¥ –æ—á–∏—Å—Ç–∫–∏ (—Å—Ç—Ä–æ–∫–∏ 541-545):**

```typescript
// –û—á–∏—â–∞–µ–º —Ç–∞–π–º–µ—Ä
const timer = this.questionTimers.get(quizId);
if (timer && timer.timerId) {
  clearTimeout(timer.timerId);  // ‚úÖ –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–∞–π–º–µ—Ä
}
this.questionTimers.delete(quizId);  // ‚úÖ –£–¥–∞–ª—è–µ–º –∏–∑ Map
```

**–¢–∞–∫–∂–µ –≤ `autoAdvanceQuestion` –µ—Å—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞ (—Å—Ç—Ä–æ–∫–∏ 521-531):**

```typescript
// –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å –∏–≥—Ä—ã
if (quiz.status !== QuizStatus.STARTED) {
  this.logger.warn(`‚ö†Ô∏è [Backend] Game not in progress, skipping auto-advance. Status: ${quiz.status}`);
  // –û—á–∏—â–∞–µ–º —Ç–∞–π–º–µ—Ä
  const timer = this.questionTimers.get(quizId);
  if (timer && timer.timerId) {
    clearTimeout(timer.timerId);
  }
  this.questionTimers.delete(quizId);
  return;  // ‚úÖ –ü—Ä–µ–∫—Ä–∞—â–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
}
```

**‚úÖ –í—ã–≤–æ–¥:** –¢–∞–π–º–µ—Ä—ã –æ—á–∏—â–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ. –î–∞–∂–µ –µ—Å–ª–∏ —Ç–∞–π–º–µ—Ä —Å—Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∏–≥—Ä—ã, –æ–Ω –Ω–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç `start-question`, –ø–æ—Ç–æ–º—É —á—Ç–æ —Å—Ç–∞—Ç—É—Å –∏–≥—Ä—ã —É–∂–µ `'finished'`.

---

## 6. –ü–æ—á–µ–º—É –ø—Ä–∏—Ö–æ–¥–∏—Ç `start-question` —Å `currentQuestionIndex: 0` –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è?

### üîç –ê–ù–ê–õ–ò–ó –ü–†–û–ë–õ–ï–ú–´

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**

1. **–§—Ä–æ–Ω—Ç–µ–Ω–¥ —Å–∞–º –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `start-question` –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è**
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –Ω–µ—Ç –ª–∏ —É –≤–∞—Å –ª–æ–≥–∏–∫–∏, –∫–æ—Ç–æ—Ä–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `start-question` –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ `game-update`
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –Ω–µ—Ç –ª–∏ —Ç–∞–π–º–µ—Ä–æ–≤ –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç—å `start-question`

2. **–°–æ–±—ã—Ç–∏–µ –±—ã–ª–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –î–û –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è, –Ω–æ –ø—Ä–∏—à–ª–æ –ü–û–°–õ–ï**
   - –í–æ–∑–º–æ–∂–Ω–∞ –∑–∞–¥–µ—Ä–∂–∫–∞ —Å–µ—Ç–∏
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –±—ç–∫–µ–Ω–¥–µ —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º `üì• [Event Received] start-question`

3. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –≤–æ–ø—Ä–æ—Å—É (–∫–æ–≥–¥–∞ —ç—Ç–æ –Ω–µ –ø–æ—Å–ª–µ–¥–Ω–∏–π –≤–æ–ø—Ä–æ—Å)**
   - –ï—Å–ª–∏ —ç—Ç–æ –Ω–µ –ø–æ—Å–ª–µ–¥–Ω–∏–π –≤–æ–ø—Ä–æ—Å, –±—ç–∫–µ–Ω–¥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –∫ —Å–ª–µ–¥—É—é—â–µ–º—É
   - –ù–æ –ø–æ—Å–ª–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –≤–æ–ø—Ä–æ—Å–∞ –ù–ï –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–µ—Ä–µ—Ö–æ–¥–∞

### ‚úÖ –ü–†–û–í–ï–†–ö–ê: –ß—Ç–æ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç–µ –ª–∏ –≤—ã `start-question` –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è `game-update` —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `'finished'`:**
   ```javascript
   // ‚ùå –ü–õ–û–•–û - –Ω–µ –¥–µ–ª–∞–π—Ç–µ —Ç–∞–∫:
   socket.on('game-update', (data) => {
     if (data.status === 'finished') {
       // –ù–ï –æ—Ç–ø—Ä–∞–≤–ª—è–π—Ç–µ start-question –∑–¥–µ—Å—å!
       socket.emit('start-question', { pin, currentQuestionIndex: 0 }); // ‚ùå
     }
   });
   
   // ‚úÖ –•–û–†–û–®–û:
   socket.on('game-update', (data) => {
     if (data.status === 'finished') {
       // –ü—Ä–æ—Å—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–π—Ç–µ —ç–∫—Ä–∞–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
       showResultsScreen();
       return; // ‚úÖ –ù–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º start-question
     }
     
     if (data.status === 'started') {
       // –¢–æ–ª—å–∫–æ –∑–¥–µ—Å—å –º–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å start-question
     }
   });
   ```

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –±—ç–∫–µ–Ω–¥–µ:**
   - –ù–∞–π–¥–∏—Ç–µ –ª–æ–≥–∏ —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º `üì• [Event Received] start-question`
   - –ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ —Ç–∞–∫–æ–π –ª–æ–≥ –ü–û–°–õ–ï –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∏–≥—Ä—ã, –∑–Ω–∞—á–∏—Ç —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–±—ã—Ç–∏–µ
   - –ï—Å–ª–∏ –Ω–µ –≤–∏–¥–∏—Ç–µ, –∑–Ω–∞—á–∏—Ç —Å–æ–±—ã—Ç–∏–µ –±—ã–ª–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —Ä–∞–Ω—å—à–µ, –Ω–æ –ø—Ä–∏—à–ª–æ –ø–æ–∑–∂–µ

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç–µ –ª–∏ –≤—ã `start-question` –ø—Ä–∏ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏:**
   ```javascript
   // ‚ùå –ü–õ–û–•–û - –Ω–µ –¥–µ–ª–∞–π—Ç–µ —Ç–∞–∫:
   socket.on('quiz-state', (data) => {
     if (data.quiz.status === 'finished') {
       socket.emit('start-question', { pin, currentQuestionIndex: 0 }); // ‚ùå
     }
   });
   ```

---

## üìã –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞

### 1. –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏—è `game-update`

```javascript
socket.on('game-update', (data) => {
  if (data.status === 'finished') {
    // ‚úÖ –ò–≥—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
    console.log('–ò–≥—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!');
    showResultsScreen();
    
    // ‚ùå –ù–ï –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º start-question
    // ‚ùå –ù–ï —Å–±—Ä–∞—Å—ã–≤–∞–µ–º currentQuestionIndex –Ω–∞ 0
    // ‚ùå –ù–ï –ø—ã—Ç–∞–µ–º—Å—è –∑–∞–ø—É—Å—Ç–∏—Ç—å –Ω–æ–≤—ã–π –≤–æ–ø—Ä–æ—Å
    
    return; // ‚úÖ –ü—Ä–µ–∫—Ä–∞—â–∞–µ–º –æ–±—Ä–∞–±–æ—Ç–∫—É
  }
  
  if (data.status === 'started') {
    // –ò–≥—Ä–∞ –∑–∞–ø—É—â–µ–Ω–∞ - –º–æ–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –≤–æ–ø—Ä–æ—Å–∞–º–∏
    // –ù–æ –ù–ï –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º start-question –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
    // –ñ–¥–∏—Ç–µ —è–≤–Ω–æ–≥–æ —Å–æ–±—ã—Ç–∏—è start-question –æ—Ç –±—ç–∫–µ–Ω–¥–∞
  }
});
```

### 2. –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏—è `start-question`

```javascript
socket.on('start-question', (data) => {
  // ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å –∏–≥—Ä—ã –ø–µ—Ä–µ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π
  if (currentGameStatus === 'finished') {
    console.warn('‚ö†Ô∏è –ü–æ–ª—É—á–µ–Ω start-question –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω–æ–π –∏–≥—Ä—ã, –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º');
    return; // ‚úÖ –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º —Å–æ–±—ã—Ç–∏–µ
  }
  
  // ‚úÖ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –∏–≥—Ä–∞ –Ω–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∞
  console.log('–í–æ–ø—Ä–æ—Å –∑–∞–ø—É—â–µ–Ω:', data.currentQuestionIndex);
  showQuestion(data.currentQuestionIndex);
});
```

### 3. –ù–µ –æ—Ç–ø—Ä–∞–≤–ª—è–π—Ç–µ `start-question` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

```javascript
// ‚ùå –ù–ï –î–ï–õ–ê–ô–¢–ï –¢–ê–ö:
// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ start-question –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ game-update
socket.on('game-update', (data) => {
  if (data.status === 'started' && data.currentQuestionIndex === 0) {
    socket.emit('start-question', { pin, currentQuestionIndex: 0 }); // ‚ùå
  }
});

// ‚úÖ –î–ï–õ–ê–ô–¢–ï –¢–ê–ö:
// –ë—ç–∫–µ–Ω–¥ —Å–∞–º –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç start-question —á–µ—Ä–µ–∑ WebSocket
// –§—Ä–æ–Ω—Ç–µ–Ω–¥ —Ç–æ–ª—å–∫–æ —Å–ª—É—à–∞–µ—Ç —ç—Ç–æ —Å–æ–±—ã—Ç–∏–µ
socket.on('start-question', (data) => {
  // –ë—ç–∫–µ–Ω–¥ —Å–∞–º —Ä–µ—à–∏–ª, –∫–æ–≥–¥–∞ –∑–∞–ø—É—Å–∫–∞—Ç—å –≤–æ–ø—Ä–æ—Å
  showQuestion(data.currentQuestionIndex);
});
```

---

## üéØ –ò—Ç–æ–≥–æ–≤—ã–π –æ—Ç–≤–µ—Ç

### ‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è:

1. **–ë—ç–∫–µ–Ω–¥ –ù–ï –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `start-question` –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∏–≥—Ä—ã**
2. **–¢–∞–π–º–µ—Ä—ã –æ—á–∏—â–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ**
3. **–°—Ç–∞—Ç—É—Å –∏–≥—Ä—ã –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π `start-question`**
4. **–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–æ–±—ã—Ç–∏–π –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è**

### üîç –ü—Ä–æ–±–ª–µ–º–∞, —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ:

–ï—Å–ª–∏ –≤—ã –≤–∏–¥–∏—Ç–µ `start-question` —Å `currentQuestionIndex: 0` –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∏–≥—Ä—ã, —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ:

1. **–§—Ä–æ–Ω—Ç–µ–Ω–¥ —Å–∞–º –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —ç—Ç–æ —Å–æ–±—ã—Ç–∏–µ** (–ø—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–¥)
2. **–ò–ª–∏ —Å–æ–±—ã—Ç–∏–µ –±—ã–ª–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —Ä–∞–Ω—å—à–µ, –Ω–æ –ø—Ä–∏—à–ª–æ –ø–æ–∑–∂–µ** (–ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –±—ç–∫–µ–Ω–¥–µ)

### üìù –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ:

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–¥**, –∫–æ—Ç–æ—Ä—ã–π –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç `game-update` —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `'finished'`
2. **–£–±–µ–¥–∏—Ç–µ—Å—å**, —á—Ç–æ –≤—ã –ù–ï –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç–µ `start-question` –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∏–≥—Ä—ã
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏** –Ω–∞ –±—ç–∫–µ–Ω–¥–µ —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º `üì• [Event Received] start-question`
4. **–î–æ–±–∞–≤—å—Ç–µ –ø—Ä–æ–≤–µ—Ä–∫—É —Å—Ç–∞—Ç—É—Å–∞** –ø–µ—Ä–µ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π `start-question` –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ

---

## üîß –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –≤—Å–µ –µ—â–µ –µ—Å—Ç—å

–ï—Å–ª–∏ –ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–±–ª–µ–º–∞ –æ—Å—Ç–∞–µ—Ç—Å—è, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤—å—Ç–µ:

1. **–õ–æ–≥–∏ —Å –±—ç–∫–µ–Ω–¥–∞** (–æ—Å–æ–±–µ–Ω–Ω–æ —Å—Ç—Ä–æ–∫–∏ —Å `üì• [Event Received] start-question` –∏ `üèÅ [Game Finish]`)
2. **–ö–æ–¥ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞**, –∫–æ—Ç–æ—Ä—ã–π –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç `game-update` –∏ `start-question`
3. **–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–æ–±—ã—Ç–∏–π**, –∫–æ—Ç–æ—Ä—É—é –≤—ã –≤–∏–¥–∏—Ç–µ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞

–¢–æ–≥–¥–∞ —Å–º–æ–∂–µ–º —Ç–æ—á–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –æ—Ç–∫—É–¥–∞ –ø—Ä–∏—Ö–æ–¥–∏—Ç `start-question` –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∏–≥—Ä—ã.

